{"version":3,"file":"common.js","mappings":"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","sources":["./src/app/core/ngrx-store/selectors/current-actions.selectors.ts","./src/app/core/ngrx-store/selectors/entities.selectors.ts","./src/app/features/photo/photo-list/akita-state/photo-list-albums.store.ts","./src/app/features/photo/photo-list/akita-state/photo-list.query.ts","./src/app/features/photo/photo-list/akita-state/photo-list.service.ts","./src/app/features/photo/photo-list/akita-state/photo-list.store.ts"],"sourcesContent":["import { createFeatureSelector, createSelector } from '@ngrx/store';\nimport { currentActionsFeatureKey, CurrentActionsState } from '../reducers/current-actions.reducer';\n\nexport const selectCurrentActionsState =\n  createFeatureSelector<CurrentActionsState>(currentActionsFeatureKey);\n\nexport const selectIsActionInProcess = (actionType: string) =>\n  createSelector(selectCurrentActionsState, (state): boolean => {\n    return state.includes(actionType);\n  });\n","import { createFeatureSelector } from '@ngrx/store';\nimport { entitiesFeatureKey, EntitiesState } from '../reducers/entities.reducer';\n\nexport const selectEntities = createFeatureSelector<EntitiesState>(entitiesFeatureKey);\n","import { Injectable } from '@angular/core';\nimport { EntityState, EntityStore, StoreConfig } from '@datorama/akita';\nimport { NormalizedAlbumEntity } from '../../../../core/normalizr/types/models/normalized-album-entity';\n\nexport interface PhotoListAlbumsState extends EntityState<NormalizedAlbumEntity> {}\n\n@Injectable({ providedIn: 'root' })\n@StoreConfig({ name: 'photo-list-albums' })\nexport class PhotoListAlbumsStore extends EntityStore<PhotoListAlbumsState> {\n  // eslint-disable-next-line @typescript-eslint/no-useless-constructor\n  constructor() {\n    super();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { QueryEntity } from '@datorama/akita';\nimport { PhotoListStore, PhotoListState } from './photo-list.store';\nimport { Observable } from 'rxjs';\n\n@Injectable({ providedIn: 'root' })\nexport class PhotoListQuery extends QueryEntity<PhotoListState> {\n  constructor(protected override store: PhotoListStore) {\n    super(store);\n  }\n\n  isLastPage(): Observable<boolean> {\n    return this.select((state) => {\n      return state.totalCount === state.ids!.length;\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { PhotoListStore, PhotoListState } from './photo-list.store';\nimport {\n  PageRequest,\n  PageRequestFilterField,\n} from '../../../../core/types/pagination/page-request';\nimport { ApiService } from '../../../../core/services/api.service';\nimport { PhotoListAlbumsStore } from './photo-list-albums.store';\n\n@Injectable({ providedIn: 'root' })\nexport class PhotoListService {\n  constructor(\n    private photoStore: PhotoListStore,\n    private albumsStore: PhotoListAlbumsStore,\n    private apiService: ApiService,\n  ) {}\n\n  getPhotos(pageRequest: PageRequest): void {\n    this.photoStore.setLoading(true);\n    this.apiService.getPhotos(pageRequest).subscribe({\n      next: (pageResult) => {\n        this.photoStore.setLoading(false);\n        this.photoStore.updateList(pageResult);\n      },\n      error: () => {\n        this.photoStore.setLoading(false);\n      },\n    });\n  }\n\n  getNextPhotos(): void {\n    const state: PhotoListState = this.photoStore.getValue();\n\n    const currentPageRequest: PageRequest = state.pageRequest;\n\n    this.getPhotos({\n      ...currentPageRequest,\n      page: {\n        number: currentPageRequest.page!.number + 1,\n        size: currentPageRequest.page!.size,\n      },\n    });\n  }\n\n  getAlbums(pageRequest: PageRequest): void {\n    this.apiService.getAlbums(pageRequest).subscribe((pageResult) => {\n      this.albumsStore.set(pageResult.items);\n    });\n  }\n\n  updateFilter(filter: PageRequestFilterField[]): void {\n    const state: PhotoListState = this.photoStore.getValue();\n\n    const currentPageRequest: PageRequest = state.pageRequest;\n\n    this.getPhotos({\n      ...currentPageRequest,\n      page: {\n        number: 1,\n        size: currentPageRequest.page!.size,\n      },\n      filter,\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EntityState, EntityStore, StoreConfig } from '@datorama/akita';\nimport { PageResult } from '../../../../core/types/pagination/page-result';\nimport { PageRequest } from '../../../../core/types/pagination/page-request';\nimport { NormalizedPhotoEntity } from '../../../../core/normalizr/types/models/normalized-photo-entity';\n\nexport interface PhotoListState extends EntityState<NormalizedPhotoEntity> {\n  totalCount: number;\n  pageRequest: PageRequest;\n}\n\nconst initialState: PhotoListState = {\n  totalCount: 0,\n  pageRequest: {},\n};\n\n@Injectable({ providedIn: 'root' })\n@StoreConfig({ name: 'photo-list' })\nexport class PhotoListStore extends EntityStore<PhotoListState> {\n  constructor() {\n    super(initialState);\n  }\n\n  updateList(pageResult: PageResult<NormalizedPhotoEntity>): void {\n    const { items, totalCount, pageRequest } = pageResult;\n\n    if (pageResult.pageRequest.page?.number === 1) {\n      this.set(items);\n    } else {\n      this.add(items);\n    }\n\n    this.update({\n      totalCount,\n      pageRequest,\n    });\n  }\n}\n"],"names":[],"sourceRoot":"webpack:///"}