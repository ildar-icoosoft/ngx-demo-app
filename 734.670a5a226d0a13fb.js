"use strict";(self.webpackChunkngx_demo_app=self.webpackChunkngx_demo_app||[]).push([[734],{3734:(et,x,r)=>{r.r(x),r.d(x,{AlbumListModule:()=>l});var f,a=r(9808),O=r(8775),m=r(655),u=r(44),D=r(1291),Z=r(3349),T=r(6696),p=r(220),y=r(620),t=r(5e3);let d=f=class{getAlbums(n,o){var c;const v=o.data.result,C=n.getState();n.setState(Object.assign(Object.assign({},v),{items:1===(null===(c=v.pageRequest.page)||void 0===c?void 0:c.number)?v.items:[...C.items,...v.items]})),n.dispatch(new y.$.GetPhotos({filter:v.items.map(I=>({field:"albumId",value:""+I}))}))}static items(n,o){return(0,D.cY)(n.items,[Z.A],o).filter(c=>!!c)}static isLastPage(n){return n.totalCount===n.items.length}};d.\u0275fac=function(n){return new(n||d)},d.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac}),(0,m.gn)([(0,u.aU)(p.K.GetAlbumsSuccess)],d.prototype,"getAlbums",null),(0,m.gn)([(0,u.Qf)([f,T.w])],d,"items",null),(0,m.gn)([(0,u.Qf)()],d,"isLastPage",null),d=f=(0,m.gn)([(0,u.ZM)({name:"albumList",defaults:{pageRequest:{},totalCount:0,items:[]}})],d);var S,R=r(9030),M=r(2481),nt=r(6462);let h=S=class{getPhotos(n,o){const v=o.pageResult.items.reduce((C,I)=>(C[I.album]||(C[I.album]=[]),C[I.album].length<4&&C[I.album].push(I.id),C),{});n.setState(Object.assign(Object.assign({},n.getState()),v))}static groupedPhotos(n,o){const c={};for(let v in n)c[v]=(0,D.cY)(n[v],[nt.J],o).filter(C=>!!C);return c}};h.\u0275fac=function(n){return new(n||h)},h.\u0275prov=t.Yz7({token:h,factory:h.\u0275fac}),(0,m.gn)([(0,u.aU)(y.$.GetPhotosSuccess)],h.prototype,"getPhotos",null),(0,m.gn)([(0,u.Qf)([S,T.w])],h,"groupedPhotos",null),h=S=(0,m.gn)([(0,u.ZM)({name:"albumPhotosList",defaults:{}})],h);var U,B=r(2834),F=r(151);let b=U=class{getUsers(n,o){n.setState(o.data.result.items)}static items(n,o){return(0,D.cY)(n,[F.I],o).filter(c=>!!c)}};b.\u0275fac=function(n){return new(n||b)},b.\u0275prov=t.Yz7({token:b,factory:b.\u0275fac}),(0,m.gn)([(0,u.aU)(M.E.GetUsersSuccess)],b.prototype,"getUsers",null),(0,m.gn)([(0,u.Qf)([U,T.w])],b,"items",null),b=U=(0,m.gn)([(0,u.ZM)({name:"userList",defaults:[]})],b);var g=r(3075),z=r(9468),G=r(4986),E=r(911);function K(e,n){if(1&e&&(t.TgZ(0,"option",3),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.Q6J("value",o.id),t.xp6(1),t.Oqu(o.name)}}let L=class{constructor(){this.users=[],this.changeFilter=new t.vpe,this.group=new g.cw({q:new g.NI(""),userId:new g.NI("0")})}ngOnInit(){this.group.valueChanges.pipe((0,z.p)(1e3,G.z,{trailing:!0}),(0,E.t)(this)).subscribe(n=>{const o=[];n.q&&o.push({field:"q",value:n.q}),"0"!==n.userId&&o.push({field:"userId",value:n.userId}),this.changeFilter.emit(o)})}trackByUser(n,o){return o.id}};L.\u0275fac=function(n){return new(n||L)},L.\u0275cmp=t.Xpm({type:L,selectors:[["app-album-list-filter"]],inputs:{users:"users"},outputs:{changeFilter:"changeFilter"},decls:6,vars:4,consts:[[1,"d-flex",3,"formGroup"],["formControlName","q","placeholder","Search",1,"form-control","me-2"],["formControlName","userId","aria-label","User filter",1,"form-select"],[3,"value"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"]],template:function(n,o){1&n&&(t.TgZ(0,"form",0),t._UZ(1,"input",1),t.TgZ(2,"select",2)(3,"option",3),t._uU(4,"Author"),t.qZA(),t.YNc(5,K,2,2,"option",4),t.qZA()()),2&n&&(t.Q6J("formGroup",o.group),t.xp6(3),t.Q6J("value",0),t.xp6(2),t.Q6J("ngForOf",o.users)("ngForTrackBy",o.trackByUser))},directives:[g._Y,g.JL,g.sg,g.Fj,g.JJ,g.u,g.EJ,g.YN,g.Kr,a.sg],styles:[""],changeDetection:0}),L=(0,m.gn)([(0,E.c)()],L);class P{constructor(n){this.store=n}changeFilter(n){const o=this.store.selectSnapshot(d).pageRequest;this.store.dispatch(new p.K.GetAlbums(Object.assign(Object.assign({},o),{page:{number:1,size:o.page.size},filter:n})))}}P.\u0275fac=function(n){return new(n||P)(t.Y36(u.yh))},P.\u0275cmp=t.Xpm({type:P,selectors:[["app-album-list-filter-container"]],decls:2,vars:3,consts:[[3,"users","changeFilter"]],template:function(n,o){1&n&&(t.TgZ(0,"app-album-list-filter",0),t.NdJ("changeFilter",function(v){return o.changeFilter(v)}),t.ALo(1,"async"),t.qZA()),2&n&&t.Q6J("users",t.lcZ(1,1,o.users$))},directives:[L],pipes:[a.Ov],styles:[""],changeDetection:0}),(0,m.gn)([(0,u.Ph)(b.items)],P.prototype,"users$",void 0);var k=r(801),J=r(6974),Q=r(7408);const $=function(e){return["/","photo",e]};function H(e,n){if(1&e&&(t.TgZ(0,"a",3),t._UZ(1,"img",8),t.qZA()),2&e){const o=n.$implicit;t.Q6J("routerLink",t.VKq(3,$,o.id)),t.xp6(1),t.Q6J("src",o.thumbnailUrl,t.LSH)("alt",o.title)}}const w=function(e){return["/","user",e]};function X(e,n){if(1&e&&(t.TgZ(0,"div",9),t._uU(1," By "),t.TgZ(2,"a",3),t._uU(3),t.qZA()()),2&e){const o=t.oxw(2);t.xp6(2),t.Q6J("routerLink",t.VKq(2,w,o.album.user.id)),t.xp6(1),t.Oqu(o.album.user.name)}}const V=function(e){return["/","album",e]};function W(e,n){if(1&e&&(t.TgZ(0,"div",1)(1,"div",2)(2,"a",3),t._uU(3),t.qZA()(),t.TgZ(4,"div",4)(5,"div",5),t.YNc(6,H,2,5,"a",6),t.qZA()(),t.YNc(7,X,4,4,"div",7),t.qZA()),2&e){const o=t.oxw();t.xp6(2),t.Q6J("routerLink",t.VKq(6,V,o.album.id)),t.xp6(1),t.AsE("",o.album.id,". ",o.album.title,""),t.xp6(3),t.Q6J("ngForOf",o.photos)("ngForTrackBy",o.trackByPhoto),t.xp6(1),t.Q6J("ngIf",o.album.user)}}let N=(()=>{class e{constructor(){this.photos=[]}trackByPhoto(o,c){return c.id}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-album-list-item"]],inputs:{album:"album",photos:"photos"},decls:1,vars:1,consts:[["class","card text-center",4,"ngIf"],[1,"card","text-center"],[1,"card-header"],[3,"routerLink"],[1,"card-body"],[1,"album-photos","d-flex"],[3,"routerLink",4,"ngFor","ngForOf","ngForTrackBy"],["class","card-footer text-muted",4,"ngIf"],[3,"src","alt"],[1,"card-footer","text-muted"]],template:function(o,c){1&o&&t.YNc(0,W,8,8,"div",0),2&o&&t.Q6J("ngIf",c.album)},directives:[a.O5,O.yS,a.sg],styles:[".album-photos[_ngcontent-%COMP%]{gap:10px}.album-photos[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:calc(25% - 7.5px)}.album-photos[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),e})();var j=r(9444);const st=function(){return[]};function _(e,n){if(1&e&&t._UZ(0,"app-album-list-item",4),2&e){const o=n.$implicit,c=t.oxw();t.Q6J("album",o)("photos",c.groupedPhotos[o.id]||t.DdM(2,st))}}function q(e,n){if(1&e&&(t.TgZ(0,"div",5)(1,"fa-icon",6)(2,"span",7),t._uU(3,"Loading..."),t.qZA()()()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("icon",o.faSpinner)("pulse",!0)}}let tt=(()=>{class e{constructor(){this.albums=[],this.groupedPhotos={},this.isLastPage=!0,this.loadInProcess=null,this.loadMore=new t.vpe,this.faSpinner=k.LM3}trackByAlbum(o,c){return c.id}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-album-list"]],inputs:{albums:"albums",groupedPhotos:"groupedPhotos",isLastPage:"isLastPage",loadInProcess:"loadInProcess"},outputs:{loadMore:"loadMore"},decls:4,vars:6,consts:[[3,"isEmpty","isLoading"],["infiniteScroll","",1,"album-list","d-flex","flex-wrap",3,"infiniteScrollDisabled","scrolled"],[3,"album","photos",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center",4,"ngIf"],[3,"album","photos"],[1,"text-center"],["role","status","data-testid","loading-spinner",3,"icon","pulse"],[1,"sr-only"]],template:function(o,c){1&o&&(t._UZ(0,"app-content-loading-status",0),t.TgZ(1,"div",1),t.NdJ("scrolled",function(){return c.loadMore.emit()}),t.YNc(2,_,1,3,"app-album-list-item",2),t.qZA(),t.YNc(3,q,4,2,"div",3)),2&o&&(t.Q6J("isEmpty",!c.albums.length)("isLoading",!!c.loadInProcess),t.xp6(1),t.Q6J("infiniteScrollDisabled",c.isLastPage),t.xp6(1),t.Q6J("ngForOf",c.albums)("ngForTrackBy",c.trackByAlbum),t.xp6(1),t.Q6J("ngIf",!!c.loadInProcess&&c.albums.length))},directives:[J.u,Q.Ry,a.sg,N,a.O5,j.BN],styles:[".album-list[_ngcontent-%COMP%]{gap:20px}.album-list[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:calc(25% - 15px)}"],changeDetection:0}),e})();class A{constructor(n){this.store=n,this.breadcrumbs=[{link:"",text:"Dashboard"},{link:null,text:"Albums"}]}ngOnInit(){this.store.dispatch(new p.K.GetAlbums({page:{number:1,size:28}})),this.store.dispatch(new M.E.GetUsers({}))}loadMore(){const n=this.store.selectSnapshot(d).pageRequest;this.store.dispatch(new p.K.GetAlbums(Object.assign(Object.assign({},n),{page:{number:n.page.number+1,size:n.page.size}})))}}A.\u0275fac=function(n){return new(n||A)(t.Y36(u.yh))},A.\u0275cmp=t.Xpm({type:A,selectors:[["app-album-list-page"]],decls:10,vars:13,consts:[[1,"container","pt-3"],[3,"items"],[1,"d-block","mb-2"],[3,"albums","groupedPhotos","isLastPage","loadInProcess","loadMore"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"app-breadcrumbs",1),t.TgZ(2,"h2"),t._uU(3,"Albums"),t.qZA(),t._UZ(4,"app-album-list-filter-container",2),t.TgZ(5,"app-album-list",3),t.NdJ("loadMore",function(){return o.loadMore()}),t.ALo(6,"async"),t.ALo(7,"async"),t.ALo(8,"async"),t.ALo(9,"async"),t.qZA()()),2&n&&(t.xp6(1),t.Q6J("items",o.breadcrumbs),t.xp6(4),t.Q6J("albums",t.lcZ(6,5,o.albums$))("groupedPhotos",t.lcZ(7,7,o.groupedPhotos$))("isLastPage",t.lcZ(8,9,o.isLastPage$))("loadInProcess",t.lcZ(9,11,o.loadInProcess$)))},directives:[B.n,P,tt],pipes:[a.Ov],styles:[""],changeDetection:0}),(0,m.gn)([(0,u.Ph)(d.items)],A.prototype,"albums$",void 0),(0,m.gn)([(0,u.Ph)(d.isLastPage)],A.prototype,"isLastPage$",void 0),(0,m.gn)([(0,u.Ph)((0,R.dj)([p.K.GetAlbums]))],A.prototype,"loadInProcess$",void 0),(0,m.gn)([(0,u.Ph)(h.groupedPhotos)],A.prototype,"groupedPhotos$",void 0);const ot=[{path:"",component:A}];let i=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[O.Bz.forChild(ot)],O.Bz]}),e})();var s=r(4466);let l=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[a.ez,i,s.m,u.$l.forFeature([d,b,h])]]}),e})()},2834:(et,x,r)=>{r.d(x,{n:()=>T});var a=r(5e3),O=r(9808),m=r(8775);function u(p,y){if(1&p&&(a.TgZ(0,"span"),a._uU(1),a.qZA()),2&p){const t=a.oxw(),d=t.$implicit;a.ekj("active",t.last),a.xp6(1),a.Oqu(d.text)}}function D(p,y){if(1&p&&(a.TgZ(0,"a",6),a._uU(1),a.qZA()),2&p){const t=a.oxw(),d=t.$implicit;a.ekj("active",t.last),a.Q6J("routerLink",d.link),a.xp6(1),a.Oqu(d.text)}}function Z(p,y){if(1&p&&(a.TgZ(0,"li",3),a.YNc(1,u,2,3,"span",4),a.YNc(2,D,2,4,"ng-template",null,5,a.W1O),a.qZA()),2&p){const t=y.$implicit,f=a.MAs(3);a.xp6(1),a.Q6J("ngIf",null===t.link)("ngIfElse",f)}}let T=(()=>{class p{constructor(){this.items=[]}}return p.\u0275fac=function(t){return new(t||p)},p.\u0275cmp=a.Xpm({type:p,selectors:[["app-breadcrumbs"]],inputs:{items:"items"},decls:3,vars:1,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],["class","breadcrumb-item",4,"ngFor","ngForOf"],[1,"breadcrumb-item"],[3,"active",4,"ngIf","ngIfElse"],["withLink",""],[3,"routerLink"]],template:function(t,f){1&t&&(a.TgZ(0,"nav",0)(1,"ol",1),a.YNc(2,Z,4,2,"li",2),a.qZA()()),2&t&&(a.xp6(2),a.Q6J("ngForOf",f.items))},directives:[O.sg,O.O5,m.yS],styles:[""],changeDetection:0}),p})()},911:(et,x,r)=>{r.d(x,{c:()=>W,t:()=>A});var a=r(4408);let m,O=1;const u={};function D(i){return i in u&&(delete u[i],!0)}const Z={setImmediate(i){const s=O++;return u[s]=!0,m||(m=Promise.resolve()),m.then(()=>D(s)&&i()),s},clearImmediate(i){D(i)}},{setImmediate:p,clearImmediate:y}=Z,t={setImmediate(...i){const{delegate:s}=t;return((null==s?void 0:s.setImmediate)||p)(...i)},clearImmediate(i){const{delegate:s}=t;return((null==s?void 0:s.clearImmediate)||y)(i)},delegate:void 0};var d=r(7565);new class R extends d.v{flush(s){this._active=!0;const l=this._scheduled;this._scheduled=void 0;const{actions:e}=this;let n;s=s||e.shift();do{if(n=s.execute(s.state,s.delay))break}while((s=e[0])&&s.id===l&&e.shift());if(this._active=!1,n){for(;(s=e[0])&&s.id===l&&e.shift();)s.unsubscribe();throw n}}}(class f extends a.o{constructor(s,l){super(s,l),this.scheduler=s,this.work=l}requestAsyncId(s,l,e=0){return null!==e&&e>0?super.requestAsyncId(s,l,e):(s.actions.push(this),s._scheduled||(s._scheduled=t.setImmediate(s.flush.bind(s,void 0))))}recycleAsyncId(s,l,e=0){if(null!=e&&e>0||null==e&&this.delay>0)return super.recycleAsyncId(s,l,e);s.actions.some(n=>n.id===l)||(t.clearImmediate(l),s._scheduled=void 0)}});var S=r(7579),Y=r(727),F=(r(457),r(515),r(5e3)),z=(r(5577),r(5363),r(262),r(2722));const G=F.GuJ,K=Symbol("__destroy"),L=Symbol("__decoratorApplied");function P(i){return"string"==typeof i?Symbol(`__destroy__${i}`):K}function J(i,s){i[s]||(i[s]=new S.x)}function Q(i,s){i[s]&&(i[s].next(),i[s].complete(),i[s]=null)}function $(i){i instanceof Y.w0&&i.unsubscribe()}function w(i,s){return function(){var l;if(i&&i.call(this),Q(this,P()),s.arrayName&&function H(i){Array.isArray(i)&&i.forEach($)}(this[s.arrayName]),s.checkProperties)for(const e in this)(null===(l=s.blackList)||void 0===l?void 0:l.includes(e))||$(this[e])}}function W(i={}){return s=>{!function E(i){return!!i[G]}(s)?function X(i,s){i.prototype.ngOnDestroy=w(i.prototype.ngOnDestroy,s)}(s,i):function V(i,s){const l=i.\u0275pipe;l.onDestroy=w(l.onDestroy,s)}(s,i),function k(i){i.prototype[L]=!0}(s)}}function A(i,s){return l=>{const e=P(s);return"string"==typeof s?function tt(i,s,l){const e=i[s];J(i,l),i[s]=function(){e.apply(this,arguments),Q(this,l),i[s]=e}}(i,s,e):J(i,e),l.pipe((0,z.R)(i[e]))}}Symbol("CheckerHasBeenSet")}}]);